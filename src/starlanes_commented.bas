REM Variables
REM
REM Everything is 1-based unless otherwise specified.
REM
REM B(I)
REM D1(5)
REM I        Temporary: current player number
REM K        Current turn (initialized to 0)
REM M$(5)    Company names
REM M$       Characters A-L for map column labels
REM M(10,13) The map, 10 rows, 13 columns
REM N$(5)
REM P        Current player number
REM P$(I)    Player name
REM P1       Total number of players
REM Q(5)     Number of spaces occupied by company I
REM R(5)     Candidate space rows
REM C(5)     Candidate space columns
REM R$       Temporary: hold player response to question
REM S1(5)
REM S(5,4)
REM
REM Map Values
REM
REM 1: Empty Space
REM 2: Unattached outpost
REM 3: Star
REM 4: Company 1 (A)
REM 5: Company 2 (B)
REM 6: Company 3 (C)
REM 7: Company 4 (D)
REM 8: Company 5 (E)
REM
REM Company Names
REM
REM 1: ALTAIR STARWAYS
REM 2: BETELGEUSE, LTD.
REM 3: CAPELLA FREIGHT CO.
REM 4: DENEBOLA SHIPPERS
REM 5: ERIDANI EXPEDITERS
REM
REM Game over
REM 
REM The game ends when the current turn reaches 48.
REM

10 REM THE GAME OF STAR LANES - AN INTERSTELLAR COMMERCE GAME
20 REM FOR 2-4 PLAYERS - COPYRIGHT 1977 BY STEVEN FABER
30 REM WRITTEN IN ALTAIR BASIC 12/17/76

REM Print title
REM CHR$(12) is formfeed

40 PRINT CHR$(12): PRINT: PRINT: PRINT TAB(10)"* S * T * A * R **";
50 PRINT " L * A * N * E * S *"

REM Array dimensions

60 DIM M(10,13), S(5,4), N$(5), D1(5), S1(5), Q(5)

REM Initialize company names and ???

70 M$(5) = "ERIDANI EXPEDITERS": FOR I=1 TO 5: FOR J=1 TO 4: S(I,J)=0
75 D1(I) = 0: S1(I) = 100: Q(I) = 0: B(I) = 6000: NEXT J,I
80 M$(3) = "CAPELLA FREIGHT CO.": M$(4) = "DENEBOLA SHIPPERS"
90 M$(1) = "ALTAIR STARWAYS": M$(2) = "BETELGEUSE, LTD."

REM Populate map
REM
REM There's a 1/20 chance that space will be a star, else it's empty
REM space.

100 L$ = ".+*ABCDE": M$ = "ABCDEFGHIJKL": FOR I=1 TO 9: FOR J=1 TO 12
110 IF INT(RND(1)*20)+1 <> 10 THEN M(I,J) = 1: GOTO130
120 M(I,J) = 3

REM Get player count and ask about instructions
130 NEXT J,I: INPUT "HOW MANY PLAYERS (2-4)";P1
140 INPUT "DOES ANY PLAYER NEED INSTRUCTIONS";R$
150 IF LEFT$(R$,1) = "Y" THEN GOSUB 8000

REM Get player names

160 FOR I=1 TO P1: PRINT"PLAYER";I;: INPUT "WHAT IS YOUR NAME";P$(I)

REM Choose first player

170 NEXT I: PRINT: PRINT "NOW I WILL DECIDED WHO GOES FIRST...": PRINT
180 I = INT(P1*RND(1)+1): PRINT P$(I);" IS THE FIRST PLAYER TO MOVE."

REM Current turn to 0, current player to first chosen player, then jump
REM over end of game check and incrementing current player number.

185 K = 0
190 P = I: GOTO 220

REM *MAIN LOOP START*
REM
REM Check for game over.

200 K = K + 1: IF K = 48 THEN 9500

REM Incremement player count, wrapping around.

210 P = P + 1: IF P = P1 + 1 THEN P = 1

REM Choose 5 unique, empty sites (row, column) as candidate moves. Line
REM 240 verifies uniqueness. Line 250 verifies emptiness.

220 FOR I = 1 TO 5
230 R(I) = INT(9*RND(1)+1): C(I) = INT(12*RND(1)+1)
240 FOR I1 = I-1 TO 0 STEP -1: IF R(I) = RI(I1) AND C(I) = C(I1) THEN 230
250 NEXT I1: IF M(R(I),C(I)) > 1 THEN 230

REM If the number of spaces occupied by any company is 0, we'll skip the
REM next block. ???

260 FOR I1 = 1 TO 5: IF Q(I1) = 0 THEN 340

REM If up, down, left, or right of
270 NEXT I1: IF M(R(I),C(I)+1) > 3 OR M(R(I),C(I)-1)>3 THEN 340
280 IF M(R(I)+1,C(I)) > 3 OR M(R(I)-1),C(I)) > 3 THEN 340

290 A1=M(R(I),C(I)+1):A2=M(R(I),C(I)-1)
300 A3=M(R(I)+1,C(I)):A4=M(R(I)-1,C(I))
310 IFA1=2ANDA2<4ANDA3<4ANDA4<4THEN230
315 IFA2=2ANDA1<4ANDA3<4ANDA4<4THEN230
320 IFA3=2ANDA1<4ANDA2<4ANDA4<4THEN230
325 IFA4=2ANDA1<4ANDA2<4ANDA3<4THEN230
330 IFA1=3ANDA2<4ANDA3<4ANDA4<4THEN230
332 IFA2=3ANDA1<4ANDA3<4ANDA4<4THEN230
335 IFA3=3ANDA1<4ANDA2<4ANDA4<4THEN230
337 IFA4=3ANDA1<4ANDA2<4ANDA3<4THEN230
340 NEXTI:GOSUB1000:PRINT:PRINTP$(P);
350 PRINT", HERE ARE YOUR LEGAL MOVES FOR THIS TURN:"
360 FORI=1TO5:PRINTR(I);MID$(M$,C(I),1);" /";NEXTI:PRINT
370 INPUT"WHAT IS YOUR MOVE";R$:IFLEFT$(R$,1)="M"THENGOSUB1000:GOTO350
372 IFLEFT$(R$,1)="S"THENGOSUB1440:GOTO350
375 R=VAL(LEFT$(R$,1))
380 C=ASC(RIGHT$(R$,1))-64:FORI=1TO5:IFR=R(I)ANDC=C(I)THEN400
390 NEXTI:PRINT"THAT SPACE WAS NOT INCLUDED IN THE LIST...":GOTO370
400 A1=M(R-1,C):A2=M(R+1,C):A3=M(R,C+1):A4=M(R,C-1)
410 IFA1<=1ANDA2<=1ANDA3<=1ANDA4<=1THENM(R,C)=2:GOTO800
420 IFA1>3ANDA2>3ANDA2<>A1THENGOSUB1060
430 IFA1>3ANDA3>3ANDA3<>A1THENGOSUB1060
440 IFA1>3ANDA4>3ANDA4<>A1THENGOSUB1060
450 IFA2>3ANDA3>3ANDA3<>A2THENGOSUB1060
460 IFA2>3ANDA4>3ANDA4<>A2THENGOSUB1060
470 IFA3>3ANDA4>3ANDA4<>A3THENGOSUB1060
480 IFA1<4ANDA2<4ANDA3<4ANDA4<4THEN660
490 IFM(R,C)>3THEN800
500 IFA1>3THENI=A1-3
510 IFA2>3THENI=A2-3
520 IFA3>3THENI=A3-3
530 IFA4>3THENI=A4-3
540 Q(I)=Q(I)+1:S1(I)=S1(I)+100:M(R,C)=I+3:GOTO700
660 FORI=1TO5:IFQ(I)=0THEN680
670 NEXTI:IFM(R,C)<3THENM(R,C)=2:GOTO800
680 GOSUB7900:PRINT"A NEW SHIPPING COMPANY HAS BEEN FORMED!"
690 PRINT"IT'S NAME IS ";M$(I):S(I,P)=S(I,P)+5:Q(I)=1
695 PRINT:PRINT:PRINT:PRINT:PRINT
700 IFA1=3THENS1(I)=S1(I)+500
710 IFA2=3THENS1(I)=S1(I)+500
720 IFA3=3THENS1(I)=S1(I)+500
730 IFA4=3THENS1(I)=S1(I)+500
740 IFA1=2THENS1(I)=S1(I)+100:Q(I)=Q(I)+1:M(R-1,C)=I+3
750 IFA2=2THENS1(I)=S1(I)+100:Q(I)=Q(I)+1:M(R+1,C)=I+3
760 IFA3=2THENS1(I)=S1(I)+100:Q(I)=Q(I)+1:M(R,C+1)=I+3
770 IFA4=2THENS1(I)=S1(I)+100:Q(I)=Q(I)+1:M(R,C-1)=I+3
780 IFS1(I)>=3000THENT1=I:GOSUB1400
790 M(R,C)=I+3
800 FORI=1TO5:B(P)=B(P)+INT(.05*S(I,P)*S1(I)):NEXTI
810 FORI=1TO5:IFQ(I)=0THEN900
820 PRINT"YOUR CURRENT CASH= $";B(P)
830 PRINT"BUY HOW MANY SHARES OF ";M$(I);" AT $";S1(I):PRINTTAB(5);
840 PRINT"YOU NOW OWN";S(I,P);
850 INPUTR3$:IFLEFT$(R3$,1)="M"THENR3$="":GOSUB1000:GOTO830
855 IFLEFT$(R3$,1)="S"THENR3$="":GOSUB1440:GOTO830
856 R3=VAL(R3$):R3$=""
860 IFR3*S1(I)<=B(P)THEN880
870 PRINT"YOU ONLY HAVE $";B(P);"- TRY AGAIN":GOTO830
880 IFR3=0THEN900
890 S(I,P)=S(I,P)+R3:B(P)=B(P)-(R3*S1(I))
900 NEXTI:GOTO200
1000 PRINTCHR$(12):PRINTTAB(22)"MAP OF THE GALAXY"
1010 PRINTTAB(21)"*******************"
1020 PRINTTAB(12)" A  B  C  D  E  F  G  H  I  J  K  L"
1030 FORR2=1TO9:PRINTTAB(9)R2;:FORC2=1TO12:PRINT" ";
1040 PRINTMID$(L$,M(R2,C2),1);" ";:NEXTC2:PRINT:NEXTR2
1050 RETURN
1060 F1=A1-3:IFF1<0THENF1=0
1061 F2=A2-3:IFF2<0THENF2=0
1062 F3=A3-3:IFF3<0THENF3=0
1063 F4=A4-3:IFF4<0THENF4=0
1065 T=Q(F1):T1=F1:IFQ(F2)>Q(F1)THENT=Q(F2):T1=F2
1070 IFQ(F3)>TTHENT=Q(F3):T1=F3
1080 IFQ(F4)>TTHENT=Q(F4):T1=F4
1090 IFF1=T1ORA1<4THEN1110
1100 X=F1:GOSUB1180
1110 IFF2=T1ORA2<4THEN1130
1120 X=F2:GOSUB1180
1130 IFF3=T1ORA3<4THEN1150
1140 X=F3:GOSUB1180
1150 IFF4=T1ORA4<4THEN1170
1160 X=F4:GOSUB1180
1170 RETURN
1180 GOSUB7900:PRINTM$(X);" HAS JUST BEEN MERGED INTO ";
1190 PRINTM$(T1);"!":PRINT"PLEASE NOTE THE FOLLOWING TRANSACTIONS."
1200 PRINT:PRINTTAB(4)"OLD STOCK = ";M$(X);"       NEW STOCK = ";
1210 PRINTM$(T1):PRINT
1220 PRINT"PLAYER";TAB(10)"OLD STOCK";TAB(22)"NEW STOCK";TAB(34);
1230 PRINT"TOTAL HOLDINGS";TAB(53)"BONUS PAID"
1240 FORI=1TOP1:PRINTP$(I);TAB(10)S(X,I);TAB(22)INT((.5*S(X,I))+.5);
1250 PRINTTAB(34)S(T1,I)+INT((.5*S(X,I))+.5);
1260 X1=0:FORI1=1TOP1:X1=X1+S(X,I1):NEXTI1
1265 PRINTTAB(53);
1270 PRINT" $";INT(10*((S(X,I)/X1)*S1(X))):NEXTI
1290 FORI=1TOP1:S(T1,I)=S(T1,I)+INT((.5*S(X,I))+.5)
1300 B(I)=B(I)+INT(10*((S(X,I)/X1)*S1(X))):NEXTI
1310 FORI=1TO9:FORJ=1TO12:IFM(I,J)=X+3THENM(I,J)=T1+3
1315 NEXTJ,I
1317 A1=M(R-1,C):A2=M(R+1,C):A3=M(R,C+1):A4=M(R,C-1)
1318 F1=A1-3:IFF1<0THENF1=0
1319 F2=A2-3:IFF2<0THENF2=0
1320 Q(T1)=Q(T1)+Q(X):S1(T1)=S1(T1)+S1(X):IFS1(T1)>3000THENGOSUB1400
1321 F3=A3-3:IFF3<0THENF3=0
1322 F4=A4-3:IFF4<0THENF4=0
1340 S1(X)=100:Q(X)=0:FORI=1TOP1:S(X,I)=0:NEXTI
1355 PRINT:PRINT:PRINT:PRINT:PRINT
1360 M(R,C)=T1+3
1370 RETURN
1400 GOSUB7900:PRINT"THE STOCK OF ";
1410 PRINTM$(T1);" HAS SPLIT 2 FOR 1!":S1(T1)=INT(S1(T1)/2)
1415 PRINT:PRINT:PRINT:PRINT:PRINT
1420 FORI1=1TOP1:S(T1,I1)=2*S(T1,I1):NEXTI1
1430 RETURN
1440 PRINTCHR$(12):PRINT
1450 PRINT"STOCK";TAB(30)"PRICE PER SHARE";TAB(50)"YOUR HOLDINGS"
1460 FORI3=1TO5:IFS1(I3)=100THEN1480
1470 PRINTM$(I3);TAB(30)S1(I3);TAB(50)S(I3,P)
1480 NEXTI3:RETURN
7900 REM INSERT BELL (CNTRL G) HERE
7910 PRINTTAB(22)"SPECIAL ANNOUNCEMENT!!":PRINT
7920 RETURN
8000 PRINT:PRINT"   STAR LANES IS A GAME OF INTERSTELLAR TRADING."
8010 PRINT"THE OBJECT OF THE GAME IS TO AMASS THE GREATEST AMOUNT"
8020 PRINT"OF MONEY. THIS IS ACCOMPLISHED BY ESTABLISHING VAST,"
8030 PRINT"INTERSTELLAR SHIPPING LANES, AND PURCHASING STOCK IN"
8040 PRINT"THE COMPANIES THAT CONTROL THOSE TRADE ROUTES. DURING"
8050 PRINT"THE COURSE OF THE GAME, STOCK APPRECIATES IN VALUE AS"
8060 PRINT"THE SHIPPING COMPANIES BECOME LARGER. ALSO, SMALLER"
8070 PRINT"COMPANIES CAN BE MERGED INTO LARGER ONES, AND STOCK"
8080 PRINT"IN THE SMALLER FIRM IS CONVERTED INTO STOCK IN THE "
8090 PRINT"LARGER ONE AS DESCRIBED BELOW.":PRINT
8100 PRINT"   EACH TURN, THE COMPUTER WILL PRESENT THE PLAYER WITH"
8120 PRINT"FIVE PROSPECTIVE SPACES TO OCCUPY ON A 9X12 MATRIX"
8130 PRINT"(ROWS 1-9, COLUMNS A-L). THE PLAYER, AFTER EXAMINING"
8140 PRINT"THE MAP OF THE GALAXY TO DECIDE WHICH SPACE HE WISHES"
8150 PRINT"TO OCCUPY, RESPONDS WITH THE ROW AND COLUMN OF THAT"
8160 PRINT"SPACE, I.E., 7E, 8A, ETC. THERE ARE FOUR POSSIBLE"
8170 PRINT"MOVES A PLAYER CAN MAKE.":PRINT
8180 PRINT"   1. HE CAN ESTABLISH AN UNATTACHED OUTPOST- IF HE"
8190 PRINT"SELECTS A SPACE THAT IS NOT ADJACENT TO A STAR, ANOTHER"
8200 PRINT"UNATTACHED OUTPOST, OR AN EXISTING SHIPPING LANE, THIS"
8210 PRINT"SPACE WILL BE DESIGNATED WITH A '+'. HE WILL THEN PROCEED"
8230 PRINT"WITH STOCK TRANSACTIONS, AS LISTED BELOW.":PRINT
8240 PRINT"   2. HE CAN ADD TO AN EXISTING LANE- IF HE SELECTS A SPACE"
8250 PRINT"WHICH IS ADJACENT TO ONE - AND ONLY ONE EXISTING SHIPPING"
8260 PRINT"LANE, THE SPACE HE SELECTS WILL BE ADDED TO THAT SHIPPING"
8270 PRINT"LANE, AND WILL BE DESIGNATED WITH THE FIRST LETTER OF "
8280 PRINT"THE COMPANY THAT OWNS THAT LANE. IF THERE ARE ANY STARS"
8290 PRINT"OR UNATTACHED OUTPOSTS ALSO ADJACENT TO THE SELECTED SPACE,"
8300 PRINT"THEY, TOO, WILL BE INCORPORATED INTO THE EXISTING LANE."
8310 PRINT"EACH NEW SQUARE ADJACENT TO A STAR ADDS $500 PER SHARE, AND"
8320 PRINT"EACH NEW OUTPOST ADDS $100 PER SHARE TO THE MARKET VALUE"
8330 PRINT"OF THE STOCK OF THAT SHIPPING COMPANY.":PRINT
8340 PRINT"   3. HE MAY ESTABLISH A NEW SHIPPING LANE- IF THERE"
8350 PRINT"ARE FIVE OR LESS EXISTING SHIPPING LANES ESTABLISHED,"
8360 PRINT"THE PLAYER MAY, GIVEN THE PROPER SPACE TO PLAY, ESTABLISH"
8370 PRINT"A NEW SHIPPING LANE. HE MAY DO THIS BY OCCUPYING A SPACE"
8380 PRINT"ADJACENT TO A STAR OR ANOTHER UNATTACHED OUTPOST, BUT "
8390 PRINT"NOT ADJACENT TO AN EXISTING SHIPPING LANE. IF HE "
8400 PRINT"ESTABLISHES A NEW SHIPPING LANE, HE IS AUTOMATICALLY"
8410 PRINT"ISSUED 5 SHARES IN THE NEW COMPANY AS A REWARD. HE"
8420 PRINT"MAY THEN PROCEED TO BUY STOCK IN THAT COMPANY, OR ANY"
8430 PRINT"OTHER ACTIVE COMPANY, AS DESCRIBED BELOW. THE MARKET "
8440 PRINT"VALUE OF THE NEW STOCK IS ESTABLISHED BY THE NUMBER OF"
8450 PRINT"STARS AND OCCUPIED SPACES AS DESCRIBED IN #2 ABOVE.":PRINT
8460 PRINT"   4. HE MAY MERGE TWO EXISTING COMPANIES- IF PLAYER"
8470 PRINT"SELECTS A SPACE ADJACENT TO TWO EXISTING SHIPPING"
8480 PRINT"LANES, A MERGER OCCURS. THE LARGER COMPANY TAKES OVER"
8490 PRINT"THE SMALLER COMPANY, THE STOCK OF THE LARGER COMPANY IS"
8500 PRINT"INCREASED IN VALUE ACCORDING TO THE NUMBER OF SPACES AND"
8510 PRINT"STARS ADDED TO ITS LANE, EACH PLAYER'S STOCK IN THE"
8520 PRINT"SMALLER COMPANY IS EXCHANGED FOR SHARES IN THE LARGER"
8530 PRINT"ON A RATIO OF 2 SHARES OF THE SMALLER = 1 SHARE OF THE"
8540 PRINT"LARGER. ALSO, EACH PLAYER IS PAID A CASH BONUS PROPORTIONAL"
8550 PRINT"TO THE PERCENTAGE OF OUTSTANDING STOCK HE HELD IN THE"
8560 PRINT"SMALLER COMPANY. NOTE: AFTER A COMPANY BECOMES DEFUNCT"
8570 PRINT"THROUGH THIS MERGER PROCESS, IT CAN REAPPEAR ELSEWHERE"
8580 PRINT"ON THE BOARD IF A NEW COMPANY IS ESTABLISHED (SEE #3 ABOVE)"
8590 PRINT:PRINT"   NEXT THE COMPUTER ADDS STOCK DIVIDENDS TO THE"
8600 PRINT"PLAYER'S CASH ON HAND (5% OF THE MARKET VALUE OF THE "
8610 PRINT"STOCK IN HIS POSSESSION), AND OFFERS HIM THE OPPORTUNITY TO"
8620 PRINT"PURCHASE STOCK IN ANY OF THE ACTIVE COMPANIES ON THE"
8630 PRINT"BOARD. STOCK MAY NOT BE SOLD, BUT THE MARKET VALUES OF"
8640 PRINT"EACH PLAYER'S STOCK IS TAKEN INTO ACCOUNT AT THE END"
8650 PRINT"OF THE GAME TO DETERMINE THE WINNER. IF THE MARKET VALUE"
8660 PRINT"OF A GIVEN STOCK EXCEEDS $3000 AT ANY TIME DURING THE "
8670 PRINT"GAME, THAT STOCK SPLITS TWO FOR ONE. THE PRICE IS CUT"
8680 PRINT"IN HALF, AND THE NUMBER OF SHARES OWNED BY EACH PLAYER"
8690 PRINT"IS DOUBLED.":PRINT
8700 PRINT"NOTE: THE PLAYER MAY LOOK AT HIS PORTFOLIO AT ANY TIME"
8710 PRINT"DURING THE COURSE OF HIS TURN BY RESPONDING WITH 'STOCK'"
8720 PRINT"TO AN INPUT STATEMENT. LIKEWISE, HE CAN REVIEW THE MAP"
8730 PRINT"OF THE GALAXY BY TYPING 'MAP' TO AN INPUT STATEMENT."
8740 PRINT:PRINT"GAME ENDS AFTER 48 MOVES. PLAYER WITH THE GREATEST"
8750 PRINT"NET WORTH AT THAT POINT IS THE WINNER.":PRINT:PRINT
8760 RETURN
9500 GOSUB7900:PRINT"THE GAME IS OVER - HERE ARE THE FINAL STANDINGS"
9505 PRINT
9510 PRINT"PLAYER";TAB(10)"CASH VALUE OF STOCK";TAB(33)"CASH ON HAND";
9520 PRINTTAB(50)"NET WORTH":PRINT
9530 FORI=1TOP1:FORJ=1TO5:D1(I)=D1(I)+(S1(J)*S(J,I)):NEXTJ,I
9640 FORI=1TOP1:PRINTP$(I);TAB(10)"$";D1(I);TAB(33)"$";B(I);
9550 PRINTTAB(50)"$";D1(I)+B(I):NEXTI
9560 INPUT"ANOTHER GAME";R$:IFLEFT$(R$,1)="Y"THEN70
